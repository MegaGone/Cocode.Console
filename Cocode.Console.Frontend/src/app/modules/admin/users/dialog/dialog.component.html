<ng-container *ngIf="newUser">
    <h2 mat-dialog-title>Datos de usuario</h2>

    <form name="userForm" [formGroup]="userForm" (ngSubmit)="createUser()">
        <mat-form-field>
            <input
                matInput
                placeholder="Nombre"
                formControlName="firstName"
                (keydown)="onKeyDown($event)"
            />
            <mat-error
                *ngIf="
                    userForm.get('firstName').invalid &&
                    userForm.get('firstName').touched
                "
            >
                Este campo es requerido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input
                matInput
                placeholder="Apellido"
                formControlName="lastName"
                (keydown)="onKeyDown($event)"
            />
            <mat-error
                *ngIf="
                    userForm.get('lastName').invalid &&
                    userForm.get('lastName').touched
                "
            >
                Este campo es requerido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <mat-select placeholder="Rol" formControlName="role">
                <mat-option *ngFor="let role of roles" [value]="role.id">{{
                    role.description
                }}</mat-option>
            </mat-select>
            <mat-error
                *ngIf="
                    userForm.get('role').invalid && userForm.get('role').touched
                "
            >
                Este campo es requerido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input
                matInput
                placeholder="Email"
                formControlName="email"
                (keydown)="onKeyDown($event)"
            />
            <mat-error
                *ngIf="
                    userForm.get('email').invalid &&
                    userForm.get('email').touched
                "
            >
                Este campo es requerido y debe ser un correo electrónico válido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input
                matInput
                type="password"
                placeholder="Contraseña"
                formControlName="password"
            />
            <mat-error
                *ngIf="
                    userForm.get('password').invalid &&
                    userForm.get('password').touched
                "
            >
                Este campo es requerido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input
                matInput
                placeholder="Documento Personal de Identificación"
                formControlName="dpi"
            />
            <mat-error
                *ngIf="
                    userForm.get('dpi').invalid && userForm.get('dpi').touched
                "
            >
                Este campo es requerido.
            </mat-error>
            <mat-error *ngIf="userForm.get('dpi')?.errors?.minlength">
                El DPI debe tener exactamente 13 dígitos.
            </mat-error>
            <mat-error *ngIf="userForm.get('dpi')?.errors?.maxlength">
                El DPI debe tener exactamente 13 dígitos.
            </mat-error>
            <mat-error *ngIf="userForm.get('dpi')?.errors?.pattern">
                El DPI debe contener solo números.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input matInput placeholder="Telefono" formControlName="telefono" />
            <mat-error
                *ngIf="
                    userForm.get('telefono').invalid &&
                    userForm.get('telefono').touched
                "
            >
                Este campo es requerido.
            </mat-error>
            <mat-error *ngIf="userForm.get('telefono')?.hasError('pattern')">
                Número de teléfono no válido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input
                matInput
                placeholder="Direccion"
                formControlName="direccion"
            />
            <mat-error
                *ngIf="
                    userForm.get('direccion').invalid &&
                    userForm.get('direccion').touched
                "
            >
                Este campo es requerido.
            </mat-error>
        </mat-form-field>

        <div mat-dialog-actions>
            <button mat-button type="button" (click)="onCancel()">
                Cancelar
            </button>
            <button
                mat-flat-button
                [color]="'primary'"
                type="submit"
                [disabled]="userForm.invalid || userForm.pristine"
            >
                Guardar
            </button>
        </div>
    </form>
</ng-container>

<ng-container *ngIf="!newUser">
    <h2 mat-dialog-title>Actualizar usuario</h2>

    <form name="userForm" [formGroup]="userForm" (ngSubmit)="updateUser()">
        <mat-form-field>
            <input
                matInput
                placeholder="Nombre"
                formControlName="firstName"
                (keydown)="onKeyDown($event)"
            />
            <mat-error
                *ngIf="
                    userForm.get('firstName').invalid &&
                    userForm.get('firstName').touched
                "
            >
                Este campo es requerido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input
                matInput
                placeholder="Apellido"
                formControlName="lastName"
                (keydown)="onKeyDown($event)"
            />
            <mat-error
                *ngIf="
                    userForm.get('lastName').invalid &&
                    userForm.get('lastName').touched
                "
            >
                Este campo es requerido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <mat-select placeholder="Rol" formControlName="role">
                <mat-option *ngFor="let role of roles" [value]="role.id">{{
                    role.description
                }}</mat-option>
            </mat-select>
            <mat-error
                *ngIf="
                    userForm.get('role').invalid && userForm.get('role').touched
                "
            >
                Este campo es requerido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input
                matInput
                placeholder="Email"
                formControlName="email"
                (keydown)="onKeyDown($event)"
            />
            <mat-error
                *ngIf="
                    userForm.get('email').invalid &&
                    userForm.get('email').touched
                "
            >
                Este campo es requerido y debe ser un correo electrónico válido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input
                matInput
                type="password"
                placeholder="Contraseña"
                formControlName="password"
            />
            <mat-error
                *ngIf="
                    userForm.get('password').invalid &&
                    userForm.get('password').touched
                "
            >
                Este campo es requerido.
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input
                matInput
                placeholder="Documento Personal de Identificación"
                formControlName="dpi"
            />
            <mat-error
                *ngIf="
                    userForm.get('dpi').invalid && userForm.get('dpi').touched
                "
            >
                Este campo es requerido.
            </mat-error>
            <mat-error *ngIf="userForm.get('dpi')?.errors?.minlength">
                El DPI debe tener exactamente 13 dígitos.
            </mat-error>
            <mat-error *ngIf="userForm.get('dpi')?.errors?.maxlength">
                El DPI debe tener exactamente 13 dígitos.
            </mat-error>
            <mat-error *ngIf="userForm.get('dpi')?.errors?.pattern">
                El DPI debe contener solo números.
            </mat-error>
        </mat-form-field>

        <div mat-dialog-actions>
            <button mat-button type="button" (click)="onCancel()">
                Cancelar
            </button>
            <button
                mat-flat-button
                [color]="'primary'"
                type="submit"
                [disabled]="userForm.invalid || userForm.pristine"
            >
                Actualizar
            </button>
        </div>
    </form>
</ng-container>
